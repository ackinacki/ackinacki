title = "Gitleaks Config for AckiNacki"

# Scan all files in the repository
[detect]
# Default is true â€” explicitly keeping it
redact = true

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|secret|token|auth)[=:]["']?[0-9a-zA-Z-_]{16,}["']?'''
tags = ["key", "API"]

[[rules]]
id = "github-token"
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9A-Za-z]{36}'''
tags = ["github", "token"]

[[rules]]
id = "gitlab-token"
description = "GitLab Personal Access Token"
regex = '''glpat-[0-9a-zA-Z\-\_]{20,}'''
tags = ["gitlab", "token"]

[[rules]]
id = "slack-token"
description = "Slack Token"
regex = '''xox[baprs]-[0-9A-Za-z-]{10,48}'''
tags = ["slack", "token"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["AWS", "key"]

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?(secret|private)?(.{0,20})?(key|token)['"][0-9a-zA-Z\/+=]{40}['"]'''
tags = ["AWS", "key"]

[[rules]]
id = "private-key"
description = "Private Key (PEM)"
regex = '''-----BEGIN (RSA|DSA|EC|OPENSSH|PGP) PRIVATE KEY-----'''
tags = ["key", "private"]

#[[rules]]
#id = "rust-env-var"
#description = "Suspicious environment variable in Rust code"
#regex = '''env!\(["'][A-Z0-9_]{8,}["']\)'''
#tags = ["rust", "env"]

[[rules]]
id = "db-connection-string"
description = "Database Connection String"
regex = '''(?i)(?:postgres|mysql|mongodb|redis|sqlserver):\/\/([^ \n]+)'''
tags = ["database", "credentials"]

# ======== Allowlist ========

[allowlist]
description = "Ignore common non-sensitive locations"
paths = [
    # TODO: tests may potentially leak real keys
    '''.*tests?/.*''',
    '''.*examples?/.*''',
    '''Cargo\.lock''',
    '''target/.*''',
    '''docs?/.*''',
    '''\.git/.*''',
    '''\.idea/.*''',
    '''\.vscode/.*''',
    # old code, all tokens are invalid or public
    '''docker/live/.*''',
    '''docker/ton-live/.*''',
    '''docker/ever-live/.*''',
    # old dead code (whatever leaked already leaked)
    '''ton-q-server/.*''',
    '''evernode-se/.*''',
]

# Ignore non-sensitive strings often seen in mock or test data
regexes = [
    '''(?i)dummy|example|sample|test|placeholder|mock''',
    '''GHSAT0AAAAAADCMNSQIMA3ZIFGSUAMDQGQY2DDV64Q''',     # dummy token from examples
]
